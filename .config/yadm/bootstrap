#!/bin/bash

system_type=$(uname -s)

# sparse checkout
# Will modify info/sparse-checkout so that the listed files will be ignored
# by yadm. This will remove README from the home directory
# See: https://git-scm.com/docs/git-read-tree#_sparse_checkout
# See: https://github.com/TheLocehiliosan/yadm/issues/93
yadm gitconfig core.sparseCheckout true
cat << EOF > "$HOME/.local/share/yadm/repo.git/info/sparse-checkout"
# generated by $0
/*
!README.md
EOF
yadm checkout --quiet

# Init submodules.
# Because Git submodule commands cannot operate without a work tree, they must
# be run from within $HOME (assuming this is the root of your dotfiles)
cd "$HOME"

echo "yadm(bootstrap): init submodules"
yadm submodule update --recursive --init
